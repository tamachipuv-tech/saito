<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>ライブ情報</title>
<style>
body { font-family: sans-serif; padding: 20px; background: #fafafa; }
section { background: #fff; padding: 12px; margin-bottom: 20px; border-radius: 8px; }
table { width: 100%; border-collapse: collapse; margin-top: 10px; }
th, td { border: 1px solid #ccc; padding: 6px; }
.calendar { display: grid; grid-template-columns: repeat(7,1fr); gap: 4px; }
.calendar div { background: #fff; padding: 8px; min-height: 60px; border-radius: 6px; border: 1px solid #ddd; }
.live-mark { font-size: 12px; color: #d14; display: block; margin-top: 4px; }
</style>
</head>
<body>

<h1>ライブ情報</h1>

<!-- 一覧 -->
<section>
  <h2>ライブ一覧</h2>
  <table id="liveTable">
    <thead><tr><th>日付</th><th>タイトル</th><th>会場</th><th>開演</th></tr></thead>
    <tbody></tbody>
  </table>
</section>

<!-- カレンダー -->
<section>
  <h2 id="calTitle"></h2>
  <div id="calendar" class="calendar"></div>
</section>

<script>
const jsonURL = "./lives.json";
let lives = [];

fetch(jsonURL).then(r => r.json()).then(data => {
  lives = data.lives;
  renderTable();
  renderCalendar();
});

function renderTable() {
  const tbody = document.querySelector("#liveTable tbody");
  tbody.innerHTML = lives.map(l => `
    <tr>
      <td>${l.date}</td>
      <td>${l.title}</td>
      <td>${l.place}</td>
      <td>${l.start_time}</td>
    </tr>
  `).join("");
}

function renderCalendar() {
  const now = new Date();
  const y = now.getFullYear(), m = now.getMonth();
  document.getElementById("calTitle").textContent = `${y}年 ${m+1}月`;
  const first = new Date(y, m, 1).getDay();
  const days = new Date(y, m+1, 0).getDate();
  const cal = document.getElementById("calendar");
  cal.innerHTML = "";

  for (let i = 0; i < first; i++) cal.innerHTML += `<div></div>`;
  for (let d = 1; d <= days; d++) {
    const dateStr = `${y}-${String(m+1).padStart(2,"0")}-${String(d).padStart(2,"0")}`;
    const todayLives = lives.filter(l => l.date === dateStr);
    cal.innerHTML += `<div><strong>${d}</strong>${
      todayLives.map(l => `<span class="live-mark">${l.title}</span>`).join("")
    }</div>`;
  }
}
</script>

</body>
</html>
